import type { Mistake, ReplayMetadata } from "./types";

export const MOCK_REPLAY: ReplayMetadata = {
  date: "2025-02-20",
  room: "Gold East",
  mode: "4p East",
  result: { rank: 2, score: 31200, delta: "+45" },
  overallAccuracy: 87.3,
  totalMistakes: 12,
  bigMistakes: 5,
};

export const MOCK_MISTAKES: Mistake[] = [
  {
    id: 1,
    round: "East 2",
    turn: 8,
    evDiff: -3.42,
    category: "Push/Fold",
    hand: ["2m","3m","4m","6m","7m","2p","3p","5p","6p","7p","4s","5s","7z"],
    drew: "7z",
    yourDiscard: "5p",
    optimalDiscard: "7z",
    boardState: {
      roundWind: "East",
      turnNumber: 8,
      dora: "4s",
      honba: 0,
      you: { seat: "South", score: 25000, discards: ["1z","9s","3z"], closedHandCount: 13, isRiichi: false, isDealer: false, openMelds: [] },
      kamicha: { seat: "East", score: 25000, discards: ["1m","9p","8s","2z","6z"], closedHandCount: 13, isDealer: true, isRiichi: false, openMelds: [] },
      toimen: { seat: "West", score: 25000, discards: ["3m","9s","1p","5z","4z","8m"], closedHandCount: 13, isRiichi: true, riichiTurnIndex: 5, openMelds: [] },
      shimocha: { seat: "North", score: 25000, discards: ["7z","1s","2z","9m"], closedHandCount: 13, isRiichi: false, openMelds: [] },
    },
    impact: {
      type: "dealt_in",
      description: "You discarded 5p two turns later and dealt into West's riichi — 7700 pt mangan (pinfu tanyao dora). Folding with 7z gave you enough safe tiles to survive.",
      pointSwing: { actual: "-7700", optimal: "0", diff: "7700" },
    },
    explanation: {
      summary: "Pushed a connecting tile into riichi when 1-2 han, 2 tiles from tenpai. Fold with the safe honor you just drew.",
      details: [
        "West declared riichi on turn 6. You drew 7z — completely safe, no value to your hand. A gift for folding.",
        "Your hand is pinfu-only at best, still 2 tiles from tenpai. Pushing 5p breaks 5-6-7p without getting closer.",
        "West's discards (early 3m, late riichi) suggest natural development — not a bluff. Expected deal-in: 5000-8000 pts.",
        "Folding costs ~8% win chance on a cheap hand. The EV math overwhelmingly favors folding.",
      ],
      principle: "When 2+ tiles from tenpai against riichi, fold unless mangan+ or fast tenpai with safe tiles along the way.",
    },
  },
  {
    id: 2,
    round: "East 3",
    turn: 5,
    evDiff: -2.87,
    category: "Efficiency",
    hand: ["1m","2m","3m","5m","5m","3p","4p","7p","8p","3s","4s","5s","6s"],
    drew: "6p",
    yourDiscard: "6s",
    optimalDiscard: "5m",
    boardState: {
      roundWind: "East",
      turnNumber: 5,
      dora: "3p",
      honba: 0,
      you: { seat: "South", score: 22800, discards: ["9m","1z"], closedHandCount: 13, isRiichi: false, isDealer: false, openMelds: [] },
      kamicha: { seat: "East", score: 27200, discards: ["7z","2z","9p"], closedHandCount: 13, isDealer: true, isRiichi: false, openMelds: [] },
      toimen: { seat: "West", score: 25000, discards: ["1z","4z"], closedHandCount: 13, isRiichi: false, openMelds: [] },
      shimocha: { seat: "North", score: 25000, discards: ["9s","5z"], closedHandCount: 13, isRiichi: false, openMelds: [] },
    },
    impact: {
      type: "missed_win",
      description: "Shimocha discarded 2s two turns later. With 3-4-5-6s intact, you'd have been tenpai. Instead won 3 turns later for less value.",
      pointSwing: { actual: "+3900", optimal: "+7700", diff: "3800" },
    },
    explanation: {
      summary: "Broke the wrong shape. Discarding 6s kills connectivity; discarding 5m keeps higher tile acceptance and preserves dora.",
      details: [
        "Your value engine is 3p (dora) in pinzu. The 6p draw locks in 3p-4p + 6p-7p-8p. Protect this.",
        "3-4-5-6s branches into multiple completions (2s, 7s). Meanwhile 5m-5m is a pair blocking flexibility.",
        "Discard 5m → 9 useful tile types (~18 tiles). Discard 6s → 6 types (~12 tiles). ~50% more acceptance.",
        "Turn 5, no riichi — pure efficiency is king. No defensive reason to hold the pair.",
      ],
      principle: "Early hand: prefer connected shapes over pairs unless the pair contributes to hand value or you have excess connectivity.",
    },
  },
  {
    id: 3,
    round: "East 1 Honba 1",
    turn: 14,
    evDiff: -1.95,
    category: "Riichi Decision",
    hand: ["4m","5m","6m","2p","3p","4p","6p","7p","8p","6s","7s","8s","3m"],
    drew: "3m",
    yourDiscard: "3m",
    optimalDiscard: "3m (with riichi)",
    boardState: {
      roundWind: "East",
      turnNumber: 14,
      dora: "6p",
      honba: 1,
      you: { seat: "East", score: 18200, discards: ["1z","4z","9m","1p","9s","2z","8m","3z","5z","1m","9p","7z","1s"], closedHandCount: 13, isRiichi: false, isDealer: true, openMelds: [] },
      kamicha: { seat: "South", score: 28500, discards: ["2z","7z","1z","9m","1m","4z","8s","1s","9p","3z","5z"], closedHandCount: 13, isRiichi: false, openMelds: [] },
      toimen: { seat: "West", score: 26300, discards: ["9s","5z","1z","7z","3z","9p","2z","8m","4z","1p","9m","8p"], closedHandCount: 13, isRiichi: false, openMelds: [] },
      shimocha: { seat: "North", score: 27000, discards: ["6z","2z","9s","1z","4z","7z","3z","1m","9m","5z"], closedHandCount: 10, isRiichi: false, openMelds: [{ type: "chi", tiles: ["1s","2s","3s"], calledFrom: 0 }] },
    },
    impact: {
      type: "position_loss",
      description: "Won dama tsumo for 2600 all. Riichi → 5200 all minimum. 7800 pt gap kept you 3rd instead of 2nd.",
      pointSwing: { actual: "+7800", optimal: "+15600", diff: "7800" },
    },
    explanation: {
      summary: "Dama'd pinfu + dora as dealer in 3rd. Riichi adds massive value and pressure — stealth isn't worth it when behind.",
      details: [
        "Tenpai on 2m-5m (two-sided, 6 live). Pinfu + dora = 2600 all. With riichi: 5200 all, plus ippatsu/uradora upside.",
        "At 18200 in 3rd as dealer, 5200 all jumps you to 2nd. 2600 all barely matters.",
        "No opposing riichi, turn 14. Dama risks exhaustive draw. Riichi pressures folds and maintains dealership.",
        "Dama logic (protect lead, trap pushers) doesn't apply — you're behind.",
      ],
      principle: "Dealer in 3rd/4th with a good wait: riichi unless already mangan+ and opponents likely to push into dama.",
    },
  },
  {
    id: 4,
    round: "East 4",
    turn: 11,
    evDiff: -1.53,
    category: "Calling Decision",
    hand: ["3m","4m","7m","8m","9m","2p","3p","4p","7s","8s","3s","3s","6z"],
    drew: null,
    yourDiscard: null,
    optimalDiscard: "Chi 5m → discard 6z",
    boardState: {
      roundWind: "East",
      turnNumber: 11,
      dora: "3s",
      honba: 0,
      you: { seat: "South", score: 31200, discards: ["1z","2z","9p","5z","7z","4z","1m","1p","9s","8p"], closedHandCount: 13, isRiichi: false, isDealer: false, openMelds: [] },
      kamicha: { seat: "East", score: 20800, discards: ["3z","6z","9m","1z","5z","2z","7z","4z","1p","5m"], closedHandCount: 13, isDealer: true, isRiichi: false, openMelds: [] },
      toimen: { seat: "West", score: 22000, discards: ["9p","1z","4z","2z","3z","9s","1s","7z"], closedHandCount: 10, isRiichi: false, openMelds: [{ type: "pon", tiles: ["6z","6z","6z"], calledFrom: 1 }] },
      shimocha: { seat: "North", score: 26000, discards: ["7z","5z","9m","1z","2z","3z","9p","8s","4z"], closedHandCount: 13, isRiichi: false, openMelds: [] },
    },
    impact: {
      type: "no_direct",
      description: "You passed. Drew 1s next, still one away. Round ended in exhaustive draw — noten (-1000). Calling → tenpai for mangan tsumo or noten payments.",
      pointSwing: { actual: "-1000", optimal: "+3000 to +8000", diff: "4000+" },
    },
    explanation: {
      summary: "Kamicha discarded 5m — chi gives instant tenpai with dora pair (3s×2). Mangan hand worth accelerating.",
      details: [
        "Chi 5m with 3m-4m, discard 6z → tenpai on 6s-9s, pair of 3s (dora×2). Open tanyao + dora 2 = mangan.",
        "Without calling: 2+ draws to tenpai, risk of opponents getting there first.",
        "Cost of opening: lose riichi/tsumo chance. Gain: immediate mangan tenpai. Strongly positive.",
        "At 31200 in 1st, a mangan locks the game. Speed > marginal value.",
      ],
      principle: "Call when the open hand is already mangan+. Menzen bonus is irrelevant at maximum useful value.",
    },
  },
  {
    id: 5,
    round: "East 2 Honba 1",
    turn: 16,
    evDiff: -1.21,
    category: "Defense",
    hand: ["2m","4m","6m","8p","9p","1s","3s","7s","9s","4z","4z","5z","6z"],
    drew: "6z",
    yourDiscard: "6m",
    optimalDiscard: "9s",
    boardState: {
      roundWind: "East",
      turnNumber: 16,
      dora: "8m",
      honba: 1,
      you: { seat: "North", score: 19800, discards: ["1z","7z","3z","5m","2z","1p","8m","9m","3p","7p","4p","2s","5s","6s","8s"], closedHandCount: 13, isRiichi: false, isDealer: false, openMelds: [] },
      kamicha: { seat: "West", score: 28200, discards: ["9p","1z","2z","4z","3z","9s","1s","7z","5z"], closedHandCount: 10, isRiichi: false, openMelds: [{ type: "chi", tiles: ["1m","2m","3m"], calledFrom: 2 }] },
      toimen: { seat: "South", score: 24000, discards: ["5z","7z","1z","3z","4z","2z","9p","9m","1p","8p"], closedHandCount: 13, isRiichi: false, openMelds: [] },
      shimocha: { seat: "East", score: 28000, discards: ["2z","1z","7z","3z","4z","5z","1p","9p","1m","6z","9m","3m"], closedHandCount: 13, isDealer: true, isRiichi: true, riichiTurnIndex: 11, openMelds: [] },
    },
    impact: {
      type: "dealt_in",
      description: "6m was dealer's winning tile — haneman (riichi pinfu iipeiko dora, 12000 pts). 9s was safe: 8s in pond, no souzu in dealer's pattern.",
      pointSwing: { actual: "-12000", optimal: "0", diff: "12000" },
    },
    explanation: {
      summary: "Folding against dealer riichi — chose 6m over 9s. The terminal with adjacent tiles visible was far safer than a middle tile near the dora suit.",
      details: [
        "Dealer riichi turn 12. You're folding — correct — but tile selection within the fold matters enormously vs dealer.",
        "6m: middle manzu, dora is 8m. Dealer's pond has almost no manzu (1m, 3m late). Suggests they're holding manzu shapes.",
        "9s: terminal, 8s already in your discards. Only realistic waits: tanki or 8-9s penchan — uncommon. 6m fits 4-5m, 5-6m, 6-7m.",
        "Against dealer riichi, deal-in penalty is doubled. Even 1-2% safety difference is significant.",
      ],
      principle: "Folding priority: genbutsu > adjacent tiles visible > terminals > middle tiles near dora suit. Against dealer, maximize safety margin.",
    },
  },
];
